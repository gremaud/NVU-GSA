from single_evaluation_QoI import single_eval
import numpy as np
import csv


h=0.001



nominal_values=[8.7,0,0,42,24.6,42,18,53.43,68.4,1846,0.1,5,10.5,3.00E+03,5.00E+03,0.4,3.4,1,0.03,0.05,2.9,10,10,3.20E-02,0.1,4,650,2800,-40,0.46,3.6,2.00E+03,1.30E+05,0.63,11,4.22E-03,200,243,100,1.5,9.60E-09,25,3.30E+00,8.00E-05,1.60E+00,0.1,20,6.97E-04,0.8,2.00E-03,1.03E-02,6.91E+00,2.27E-01,1.31E-01,1.73E-03,9.57E-03,1.52E-01,2.38E+01,0.1,0.7,8,15,-55,0.4,0.35,2.79E-08,6.00E-08,8.79E-08,0,1.24E-02,0.185,2.00E-03,0.1,4.80E-03,1.25E-03,7.20E-02,7.20E-03,0.1,2,0.03,2000,40,200,0.01,0.1,0.1,120,13,9.00E+02,5.00E-04,3.15E-07,0.05,0.001,0.001,1.50E-04,3.00E+03,10000,1500,2.88E+00,0.17,8.04E-05,2.00E-02,0.24,40,0.26,11.35,8.82,2.66E-03,25,9.60E-09,200,4.50E-02,25.8,1.10E-04,2.90E-05,2.30E-04,1,2.03E-03,1,5.50E-02,2,0.9,2.40E-04,-100,250,2.56E-05,1.30E-06,100,-24,8.5,3.16E-06,0.5,-30,6.10E-06,7.40E-03,30,500,-18,4.32E-05,1.34E-06,-25,4.46E-06,-94,1.29E-09,1.00E-04,2.30E-04,1,5.00E-04,1,5.00E-03,2,0.9,2.40E-04,2.50E-05,6.60E-07,50,-0.18,0.37,6.93E+12,-80,-0.4,-80.8,53.3,53.3,1.32E-03,0.3,-0.28,0.389,9.55E+11,-31.1,1.00E-04,5.00E-05,5.00E-05,5.00E-04,0.13,-27,12,4.50E-03,112,4.20E-04,12.6,-7.40E-02,1.5,7.7,1.00E-05,5.5,1.22E-03,100,9.60E-09,1.4,2.86,1.00E-01,2,1.00E-04,3.00E-03,8.52E-04,1.95E-05,1.10E-05,2,0.1,1.67E-05,9.00E-05,4.50E-01,6.00E-05,2,9.10E-02,3.75,4.00E-04,1.00E-04,1.00E-04,1.70E-02,3,1.00E+07,20,4000,6.60E+04,2.33E+05,0.6,8.60E-06,3.27E-05,29,0.161,0.1432,0.033,0,2.12E-03,228.2,3.19E-04,23.5,2.00E-03,30,0.126,0.02047,0.02]

S=np.zeros([233,200])



i=1
    
for k in range(233):
    print("starting param ", k+1, " of 233")
    QoI_index=0
    Param_Index=k
    
    if nominal_values[Param_Index]==0:
        deriv=-1
    else:

        plus=np.array(single_eval(QoI_index,Param_Index,h/2))
        minus=np.array(single_eval(QoI_index,Param_Index,-h/2))

        actual_h=nominal_values[Param_Index]*h
        deriv=(plus-minus)/actual_h
    
    S[k,:]=deriv
    
with open('./S13.csv', 'w') as csv_file:
    csv_writer = csv.writer(csv_file, delimiter=',')   
    for xx in range(k+1):
        csv_writer.writerow(S[xx,:])
    